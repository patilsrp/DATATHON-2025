<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Insights & Recommendations</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
        }
        .card {
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        }
        .chart-container {
            width: 100%;
            max-width: 700px;
            margin: auto;
        }
    </style>
</head>
<script>
    async function fetchChurnPrediction() {
        const token = localStorage.getItem("token");

        const response = await fetch("https://fastapi-service-729514074961.us-central1.run.app/predict_churn/", {
            method: "POST",
            headers: { 
                "Content-Type": "application/json",
                "Authorization": `Bearer ${token}`
            },
            body: JSON.stringify({ feature1: 5, feature2: 3.2, feature3: 1.8 })
        });

        const data = await response.json();
        alert("Churn Prediction: " + data.churn_prediction);
    }
</script>

<body>

    <div class="container mt-5">
        <h2 class="text-center mb-4">AI-Powered Insights & Recommendations</h2>

        <!-- Navigation Buttons -->
        <div class="text-center mb-4">
            <button class="btn btn-secondary me-2" onclick="goToHome()">üè† Back to Home</button>
            <button class="btn btn-primary" onclick="goToRTM()">üìä Go to Real-Time Monitoring</button>
        </div>

        <!-- Predictive Analytics Section -->
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <h4>AI-Generated Course Recommendations</h4>
                    <ul id="courseRecommendations" class="list-group mt-3">
                        <!-- AI-powered recommendations will be injected here -->
                    </ul>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <h4>Churn Probability Trend</h4>
                    <div class="chart-container">
                        <canvas id="churnChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gamification & Retention Impact Analysis -->
        <div class="row mt-4">
            <div class="col-md-6">
                <div class="card">
                    <h4>Gamification & Retention Impact</h4>
                    <div class="chart-container">
                        <canvas id="gamificationChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <h4>Engagement Strategies That Reduce Churn</h4>
                    <ul class="list-group mt-3">
                        <li class="list-group-item">üéØ Personalized Learning Paths</li>
                        <li class="list-group-item">üèÜ Leaderboards & Rewards</li>
                        <li class="list-group-item">üîî Timely Engagement Notifications</li>
                        <li class="list-group-item">üìä Data-Driven Course Adjustments</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Navigation functions
        function goToHome() {
            window.location.href = 'index.html'; // Redirect to home page
        }

        function goToRTM() {
            window.location.href = 'RTM.html'; // Redirect to Real-Time Monitoring page
        }

        // AI-Generated Course Recommendations (Mock Data)
        const recommendedCourses = [
            "üìò Advanced Python for AI",
            "üé® UI/UX Design Principles",
            "üìä Data Science with Machine Learning",
            "üìö Business Analytics for Growth",
            "üíª Web Development Mastery"
        ];
        
        const courseList = document.getElementById("courseRecommendations");
        recommendedCourses.forEach(course => {
            let li = document.createElement("li");
            li.className = "list-group-item";
            li.textContent = course;
            courseList.appendChild(li);
        });

        // Churn Probability Trend Chart
        const churnCtx = document.getElementById('churnChart').getContext('2d');
        new Chart(churnCtx, {
            type: 'line',
            data: {
                labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul"],
                datasets: [{
                    label: 'Churn Probability (%)',
                    data: [45, 42, 39, 35, 30, 28, 25],
                    borderColor: '#ff4c4c',
                    backgroundColor: 'rgba(255, 76, 76, 0.2)',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // Gamification Impact on Retention Chart
        const gamificationCtx = document.getElementById('gamificationChart').getContext('2d');
        new Chart(gamificationCtx, {
            type: 'bar',
            data: {
                labels: ["Leaderboards", "Rewards", "Quizzes", "Badges", "Challenges"],
                datasets: [{
                    label: 'Retention Increase (%)',
                    data: [30, 25, 20, 15, 10],
                    backgroundColor: ['#4caf50', '#2196f3', '#ff9800', '#e91e63', '#673ab7'],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });

    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
